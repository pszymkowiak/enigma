# Enigma config â€” generated by Ansible
[enigma]
db_path = "{{ data_dir }}/enigma.db"
key_provider = "local"
keyfile_path = "{{ data_dir }}/keys.enc"
distribution = "RoundRobin"

[enigma.chunk_strategy.Cdc]
target_size = 4194304

[s3_proxy]
listen_addr = "0.0.0.0:{{ s3_port }}"
access_key = "{{ enigma_s3_access_key }}"
secret_key = "{{ enigma_s3_secret_key }}"
default_region = "us-east-1"

[raft]
node_id = {{ node_id }}
data_dir = "{{ data_dir }}/raft"
grpc_addr = "0.0.0.0:{{ raft_port }}"
election_timeout_ms = 1000
heartbeat_interval_ms = 300
snapshot_threshold = 10000

{% for host in groups['enigma'] %}
[[raft.peers]]
id = {{ hostvars[host].node_id }}
addr = "{{ hostvars[host].ansible_host }}:{{ raft_port }}"

{% endfor %}
{% for host in groups['enigma'] %}
[[providers]]
name = "{{ host }}"
type = "S3Compatible"
bucket = "enigma-chunks"
endpoint_url = "http://{{ hostvars[host].ansible_host }}:{{ rustfs_port }}"
path_style = true
access_key = "{{ rustfs_access_key }}"
secret_key = "{{ rustfs_secret_key }}"
weight = 1

{% endfor %}
